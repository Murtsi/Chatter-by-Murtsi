(()=>{const e=io();let t=localStorage.getItem("username")||prompt("Enter your username:");t||(t="Anonymous"),localStorage.setItem("username",t),e.emit("user connected",t);const n=document.createElement("form");n.id="form";const o=document.createElement("input");o.id="input",o.setAttribute("autocomplete","off");const a=document.createElement("button");a.textContent="Send",n.appendChild(o),n.appendChild(a);const m=document.createElement("ul");m.id="messages";const c=document.createElement("button");c.id="change-username",c.textContent="Change Username",document.body.appendChild(m),document.body.appendChild(n),document.body.appendChild(c);const s=document.createElement("script");s.src="/socket.io/socket.io.js",document.head.appendChild(s),n.addEventListener("submit",(n=>{n.preventDefault(),o.value&&(e.emit("chat message",{username:t,message:o.value}),o.value="")})),e.on("chat message",(e=>{const t=document.createElement("li");t.textContent=`${e.timestamp} - ${e.username}: ${e.message}`,m.appendChild(t),window.scrollTo(0,document.body.scrollHeight)})),e.on("chat history",(e=>{e.forEach((e=>{const t=document.createElement("li");t.textContent=`${e.timestamp} - ${e.username}: ${e.message}`,m.appendChild(t)})),window.scrollTo(0,document.body.scrollHeight)})),c.addEventListener("click",(()=>{t=prompt("Enter your new username:"),t&&localStorage.setItem("username",t)}))})();